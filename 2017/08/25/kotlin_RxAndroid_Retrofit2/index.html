<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="技术博客以及记录一些自我的心情"><title>kotlin+rxandroid+retrofit2使用 | BirdGuo的博客</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">kotlin+rxandroid+retrofit2使用</h1><a id="logo" href="/.">BirdGuo的博客</a><p class="description">路漫漫其修远兮，吾将上下而求索。</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/history/"><i class="fa fa-book"> 历史</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">kotlin+rxandroid+retrofit2使用</h1><div class="post-meta">Aug 25, 2017<span> | </span><span class="category"><a href="/categories/技术/">技术</a></span></div><div class="post-content"><h2 id="添加依赖"><a href="#添加依赖" class="headerlink" title="添加依赖"></a>添加依赖</h2><ol>
<li><p>在项目目录下build.gradle中添加</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:$&#123;versions.kotlin_version&#125;&quot;</div><div class="line">classpath &quot;org.jetbrains.kotlin:kotlin-android-extensions:$&#123;versions.kotlin_version&#125;&quot;</div></pre></td></tr></table></figure>
</li>
<li><p>在app目录下build.gradle中添加<br>因为使用到了rxjava+retrofit2的网络框架所以</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">apply plugin: &apos;kotlin-android&apos;</div><div class="line">apply plugin: &apos;kotlin-android-extensions&apos;</div><div class="line"></div><div class="line">dependencies &#123;</div><div class="line">    implementation &apos;com.android.support.constraint:constraint-layout:1.0.2&apos;</div><div class="line">    compile fileTree(dir: &apos;libs&apos;, include: [&apos;*.jar&apos;])</div><div class="line">    androidTestCompile(&apos;com.android.support.test.espresso:espresso-core:2.2.2&apos;, &#123;</div><div class="line">        exclude group: &apos;com.android.support&apos;, module: &apos;support-annotations&apos;</div><div class="line">    &#125;)</div><div class="line">    compile &quot;org.jetbrains.kotlin:kotlin-stdlib-jre7:$&#123;versions.kotlin_version&#125;&quot;</div><div class="line">    compile &quot;com.android.support:appcompat-v7:$&#123;rootProject.ext.support&#125;&quot;</div><div class="line">    testCompile &apos;junit:junit:4.12&apos;</div><div class="line">    compile &apos;com.android.support.constraint:constraint-layout:1.0.2&apos;</div><div class="line"></div><div class="line">//    kapt &quot;com.android.databinding:compiler:$&#123;versions.databinding&#125;&quot;</div><div class="line"></div><div class="line">    compile &quot;com.squareup.retrofit2:retrofit:$&#123;versions.retrofit2&#125;&quot;</div><div class="line">    compile &quot;com.squareup.retrofit2:adapter-guava:$&#123;versions.retrofit2&#125;&quot;</div><div class="line">    compile &quot;com.squareup.retrofit2:converter-gson:$&#123;versions.retrofit2&#125;&quot;</div><div class="line">    compile &quot;com.squareup.retrofit2:adapter-rxjava:$&#123;versions.retrofit2&#125;&quot;</div><div class="line">    compile &quot;com.squareup.retrofit2:converter-moshi:$&#123;versions.retrofit2&#125;&quot;</div><div class="line"></div><div class="line">    // 大神写的这个库可以支持到rxjava2.X</div><div class="line">    //tab 一起使用</div><div class="line">    compile &apos;com.jakewharton.retrofit:retrofit2-rxjava2-adapter:1.0.0&apos;</div><div class="line"></div><div class="line">    compile &quot;io.reactivex.rxjava2:rxandroid:$&#123;versions.rxandroid&#125;&quot;</div><div class="line">// Because RxAndroid releases are few and far between, it is recommended you also</div><div class="line">// explicitly depend on RxJava&apos;s latest version for bug fixes and new features.</div><div class="line">    compile &quot;io.reactivex.rxjava2:rxjava:$&#123;versions.reactivex&#125;&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="页面绑定"><a href="#页面绑定" class="headerlink" title="页面绑定"></a>页面绑定</h2><ol>
<li>做了一个简单的baseActivity，用于绑定页面，简单的管理页面。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line">* Created by guoxw on 2017/5/24.</div><div class="line">* @auther guoxw</div><div class="line">* @date 2017/5/24</div><div class="line">* @desciption</div><div class="line">*/</div><div class="line">abstract class BaseActivity : AppCompatActivity() &#123;</div><div class="line"></div><div class="line">    val BTAG: String = BaseActivity::class.java.name</div><div class="line"> </div><div class="line">    /**</div><div class="line">     * 静态成员</div><div class="line">     */</div><div class="line">    companion object &#123;</div><div class="line">        //管理运行的所有activity</div><div class="line">        var mActivities: ArrayList&lt;AppCompatActivity&gt; = ArrayList()</div><div class="line">        //单例</div><div class="line">        var activity: BaseActivity? = null</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    override fun onCreate(savedInstanceState: Bundle?) &#123;</div><div class="line">        super.onCreate(savedInstanceState)</div><div class="line">        requestWindowFeature(Window.FEATURE_NO_TITLE)</div><div class="line"></div><div class="line">        setContentView(getLayoutId())</div><div class="line">      </div><div class="line">        initData()</div><div class="line">        initView()</div><div class="line">        initListener()</div><div class="line"></div><div class="line">        synchronized(mActivities) &#123;</div><div class="line">            mActivities.add(this)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    //绑定页面</div><div class="line">    abstract fun getLayoutId(): Int</div><div class="line"></div><div class="line">    //初始化页面</div><div class="line">    abstract fun initView()</div><div class="line"></div><div class="line">    //初始化data</div><div class="line">    abstract fun initData()</div><div class="line"></div><div class="line">    //监听</div><div class="line">    abstract fun initListener()</div><div class="line">	</div><div class="line">	/**</div><div class="line">     * 打开页面</div><div class="line">     *</div><div class="line">     * @param activity 需要打开的页面</div><div class="line">     * @param bundle 传的值</div><div class="line">     */</div><div class="line">    fun openActivity(activity: Class&lt;*&gt;, bundle: Bundle?) &#123;</div><div class="line">        val intent: Intent = Intent()</div><div class="line">        if (bundle != null) &#123;</div><div class="line">            intent.putExtra(&quot;data&quot;, bundle)</div><div class="line">        &#125;</div><div class="line">        intent.setClass(this, activity)</div><div class="line">        startActivity(intent)</div><div class="line">        overridePendingTransition(R.anim.screen_zoom_in, R.anim.screen_zoom_out)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 关闭所有Activity</div><div class="line">     */</div><div class="line">    fun finishAll() &#123;</div><div class="line">        //复制一份mActivities</div><div class="line">        var copy: List&lt;AppCompatActivity&gt; = ArrayList()</div><div class="line">        synchronized(mActivities) &#123;</div><div class="line">            copy = ArrayList(mActivities)</div><div class="line">        &#125;</div><div class="line">        //结束所有</div><div class="line">       copy.forEach &#123; it.finish() &#125;</div><div class="line">        //杀死当前进程</div><div class="line">        android.os.Process.killProcess(android.os.Process.myPid())</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 关闭所有Activity，除了参数传递的Activity</div><div class="line">     *</div><div class="line">     */</div><div class="line">    fun finishAll(except: AppCompatActivity) &#123;</div><div class="line">        var copy: List&lt;AppCompatActivity&gt; = ArrayList()</div><div class="line">        synchronized(mActivities) &#123;</div><div class="line">            copy = ArrayList(mActivities)</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        copy.asSequence()</div><div class="line">                .filter &#123; it !== except &#125;</div><div class="line">                .forEach &#123; it.finish() &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 退出应用</div><div class="line">     */</div><div class="line">    fun exitApp() &#123;</div><div class="line">        finishAll()</div><div class="line">        android.os.Process.killProcess(android.os.Process.myPid())</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ol>
<li>一个简单的Splash页，继承了BaseActivity。打开页面调用的就是baseActivity里的打开页面的方法。<br><strong>在kotlin中页面绑定十分简单，在xml中定义好控件的id后，在Activity里就能直接使用呢，不用一大堆的findbyId了</strong><br><strong>而且配合lambda表达式监听事件等变得格外简洁</strong><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">import android.os.Handler</div><div class="line">import com.guoxw.gankio.R</div><div class="line">import com.guoxw.gankio.ui.activities.base.BaseActivity</div><div class="line">import kotlinx.android.synthetic.main.activity_splash.*</div><div class="line"></div><div class="line">class SplashActivity : BaseActivity() &#123;</div><div class="line"></div><div class="line">    var canJump: Boolean = true</div><div class="line"></div><div class="line">    override fun getLayoutId(): Int = R.layout.activity_splash</div><div class="line"></div><div class="line">    override fun initView() &#123;</div><div class="line"></div><div class="line">        img_splash.setImageResource(R.mipmap.haden)</div><div class="line"></div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    override fun initData() &#123;</div><div class="line"></div><div class="line">        //延迟两秒跳转到MainActivity</div><div class="line">        Handler().postDelayed(&#123;</div><div class="line">            if (canJump) &#123;</div><div class="line">                openActivity(MainActivity::class.java, null)</div><div class="line">                finish()</div><div class="line">            &#125;</div><div class="line">        &#125;, 2000)</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    override fun initListener() &#123;</div><div class="line"></div><div class="line">        tv_splash_jump.setOnClickListener &#123;</div><div class="line">            //主动跳过</div><div class="line">            if (canJump) &#123;</div><div class="line">                canJump = false</div><div class="line">                openActivity(MainActivity::class.java, null)</div><div class="line">                finish()</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="Retrofit2的使用"><a href="#Retrofit2的使用" class="headerlink" title="Retrofit2的使用"></a>Retrofit2的使用</h2><p>我这使用的是GankIO的API</p>
<h3 id="定义返回类"><a href="#定义返回类" class="headerlink" title="定义返回类"></a>定义返回类</h3><p>没错，你没看错，kotlin类的定义就是那么简单。当然我这里面的泛型使用还是有点问题，kotlin还有in和out的区分，我这没做区分。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line">* Created by guoxw on 2017/5/25.</div><div class="line">* @auther guoxw</div><div class="line">* @date 2017/5/25</div><div class="line">* @desciption</div><div class="line">*/</div><div class="line">class GankResponse&lt;T&gt;(val error: Boolean, val results: T) &#123;</div><div class="line">    override fun toString(): String &#123;</div><div class="line">        return &quot;GankResponse(error=$error, result=$results)&quot;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>数据实体类，Parcelable有kotlin的插件，直接生成代码就行了。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line">data class GankData(</div><div class="line"></div><div class="line">        //id</div><div class="line">        var _id: String,</div><div class="line">        //创建时间</div><div class="line">        var createAt: String,</div><div class="line">        var desc: String,</div><div class="line">        var images: Array&lt;String&gt;?,</div><div class="line">        var publishedAt: String,</div><div class="line">        var source: String,</div><div class="line">        var type: String,</div><div class="line">        var url: String,</div><div class="line">        var used: Boolean,</div><div class="line">        var who: String</div><div class="line">) : Parcelable &#123;</div><div class="line">    fun hasImages(): Boolean = images != null</div><div class="line"></div><div class="line">    fun createTime(): String = createAt.substring(0, 10)</div><div class="line"></div><div class="line">    companion object &#123;</div><div class="line">        @JvmField val CREATOR: Parcelable.Creator&lt;GankData&gt; = object : Parcelable.Creator&lt;GankData&gt; &#123;</div><div class="line">            override fun createFromParcel(source: Parcel): GankData = GankData(source)</div><div class="line">            override fun newArray(size: Int): Array&lt;GankData?&gt; = arrayOfNulls(size)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    constructor(source: Parcel) : this(</div><div class="line">            source.readString(),</div><div class="line">            source.readString(),</div><div class="line">            source.readString(),</div><div class="line">            source.createStringArray(),</div><div class="line">            source.readString(),</div><div class="line">            source.readString(),</div><div class="line">            source.readString(),</div><div class="line">            source.readString(),</div><div class="line">            1 == source.readInt(),</div><div class="line">            source.readString()</div><div class="line">    )</div><div class="line"></div><div class="line">    override fun describeContents() = 0</div><div class="line"></div><div class="line">    override fun writeToParcel(dest: Parcel, flags: Int) &#123;</div><div class="line">        dest.writeString(_id)</div><div class="line">        dest.writeString(createAt)</div><div class="line">        dest.writeString(desc)</div><div class="line">        dest.writeStringArray(images)</div><div class="line">        dest.writeString(publishedAt)</div><div class="line">        dest.writeString(source)</div><div class="line">        dest.writeString(type)</div><div class="line">        dest.writeString(url)</div><div class="line">        dest.writeInt((if (used) 1 else 0))</div><div class="line">        dest.writeString(who)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    override fun toString(): String &#123;</div><div class="line">        return &quot;GankData(_id=&apos;$_id&apos;, createAt=&apos;$createAt&apos;, desc=&apos;$desc&apos;, images=$&#123;Arrays.toString(images)&#125;, publishedAt=&apos;$publishedAt&apos;, source=&apos;$source&apos;, type=&apos;$type&apos;, url=&apos;$url&apos;, used=$used, who=&apos;$who&apos;)&quot;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="接口定义"><a href="#接口定义" class="headerlink" title="接口定义"></a>接口定义</h3><ul>
<li><p>方法定义</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line">* Created by guoxw on 2017/5/22.</div><div class="line">* @auther guoxw</div><div class="line">* @date 2017/5/22</div><div class="line">* @desciption</div><div class="line">*/</div><div class="line">interface GankIOApi &#123;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 分类请求数据</div><div class="line">     *</div><div class="line">     * @param type</div><div class="line">     * 数据类型： 福利 | Android | iOS | 休息视频 | 拓展资源 | 前端 | all</div><div class="line">     * @param number</div><div class="line">     * 请求个数： 数字，大于0</div><div class="line">     * @param page</div><div class="line">     * 第几页：数字，大于0</div><div class="line">     */</div><div class="line">    fun getGankIOData(type: String, number: Number, page: Int): Flowable&lt;GankResponse&lt;List&lt;GankData&gt;&gt;&gt;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>API接口定义</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line">* Created by gxw on 17-5-24.</div><div class="line">* @auther gxw</div><div class="line">* @date 17-5-24</div><div class="line">* @desciption</div><div class="line">*/</div><div class="line">interface GankIOService &#123;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 分类数据: http://gank.io/api/data/数据类型/请求个数/第几页</div><div class="line">     *</div><div class="line">     * @param type</div><div class="line">     * 数据类型： 福利 | Android | iOS | 休息视频 | 拓展资源 | 前端 | all</div><div class="line">     * @param number</div><div class="line">     * 请求个数： 数字，大于0</div><div class="line">     * @param page</div><div class="line">     * 第几页：数字，大于0</div><div class="line">     *</div><div class="line">     * 测试成功</div><div class="line">     */</div><div class="line">    @GET(&quot;data/&#123;type&#125;/&#123;number&#125;/&#123;page&#125;&quot;)</div><div class="line">    fun getGankIOData(@Path(&quot;type&quot;) type: String, @Path(&quot;number&quot;) number: Number, @Path(&quot;page&quot;) page: Int): Flowable&lt;GankResponse&lt;List&lt;GankData&gt;&gt;&gt;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>外部调用方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line">* Created by gxw on 17-5-24.</div><div class="line">* @auther gxw</div><div class="line">* @date 17-5-24</div><div class="line">* @desciption</div><div class="line">*/</div><div class="line">object GankIOResetApi : GankIOApi &#123;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 分类请求数据</div><div class="line">     *</div><div class="line">     * @param type</div><div class="line">     * 数据类型： 福利 | Android | iOS | 休息视频 | 拓展资源 | 前端 | all</div><div class="line">     * @param number</div><div class="line">     * 请求个数： 数字，大于0</div><div class="line">     * @param page</div><div class="line">     * 第几页：数字，大于0</div><div class="line">     */</div><div class="line">    override fun getGankIOData(type: String, number: Number, page: Int): Flowable&lt;GankResponse&lt;List&lt;GankData&gt;&gt;&gt;</div><div class="line">            = ApiClient.retrofit.create(GankIOService::class.java).getGankIOData(type, number, page)</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="具体调用"><a href="#具体调用" class="headerlink" title="具体调用"></a>具体调用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">   val gankIOApi: GankIOResetApi = GankIOResetApi</div><div class="line">   </div><div class="line">   gankIOApi.getGankIOData(&quot;福利&quot;, 10, 1)</div><div class="line">           .observeOn(AndroidSchedulers.mainThread()).subscribeOn(Schedulers.io())</div><div class="line">           .subscribe(&#123;</div><div class="line">               res -&gt;</div><div class="line">               Log.i(&quot;MainActivity&quot;, res.toString())</div><div class="line">               if (!res.error) &#123;</div><div class="line">                   Log.i(&quot;MainActivity&quot;, &quot;result size:&quot;.plus(res.results.size))</div><div class="line">               &#125; else &#123;</div><div class="line">                  </div><div class="line">               &#125;</div><div class="line">           &#125;, &#123; e -&gt; Log.e(&quot;MainActivity&quot;, &quot;error:&quot;.plus(e.message)) &#125;, &#123;</div><div class="line">               </div><div class="line">           &#125;)</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>有点懒，就先写到这吧</p>
</div><div class="tags"><a href="/tags/kotlin/">kotlin</a></div><div class="post-nav"><a href="/2017/08/24/BlueTooth_Scan_Conn/" class="next">蓝牙扫描连接通信</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://yoursite.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/技术/">技术</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/ADB命令/" style="font-size: 15px;">ADB命令</a> <a href="/tags/android/" style="font-size: 15px;">android</a> <a href="/tags/Ubuntu/" style="font-size: 15px;">Ubuntu</a> <a href="/tags/retrofit2/" style="font-size: 15px;">retrofit2</a> <a href="/tags/rxAndroid/" style="font-size: 15px;">rxAndroid</a> <a href="/tags/kotlin/" style="font-size: 15px;">kotlin</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/08/25/kotlin_RxAndroid_Retrofit2/">kotlin+rxandroid+retrofit2使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/24/BlueTooth_Scan_Conn/">蓝牙扫描连接通信</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/18/WifiConnectHelper/">android WiFi扫描并连接</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/09/ADBOrder/">ADB命令备忘录</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/26/UbuntunShell/">Ubuntu编写简单脚本</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/07/RxUseSimple/">RxAndroid简单入门</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/07/UpImages/">retrofit2.0 上传多张图片</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://blog.csdn.net/qqyanjiang" title="阿江的博客" target="_blank">阿江的博客</a><ul></ul><a href="https://phoenixgjh.github.io" title="phoenixgjh的博客" target="_blank">phoenixgjh的博客</a><ul></ul><a href="http://blog.csdn.net/zhaoyazhi2129" title="莫兰迪不会没有瓶子的博客" target="_blank">莫兰迪不会没有瓶子的博客</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2017 <a href="/." rel="nofollow">BirdGuo的博客.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>